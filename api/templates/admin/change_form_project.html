{% extends 'admin/change_form.html' %}
{% load static %}

{% block admin_change_form_document_ready %}

{{ block.super }}

<!-- Import code from other file -->
{% include 'admin/components/render_media_form.html' %}

<script>
  // Create markdown components for text areas
  let fields = document.querySelectorAll("textarea")
  fields.forEach(field => {
    new SimpleMDE({ element: field });
  })

  // Get markdown and html content
  const markdown = `{{markdown}}`
  
  // Create copy html button
  const button_wrapper = document.querySelector(".submit-row")
  const button_str = '<input type="button" value="Copy Markdown" class="default" name="copy">'
  button_wrapper.innerHTML += button_str
  const button_elem = document.querySelector ('input[name="copy"]')
  
  // Add copy function to button
  button_elem.addEventListener("click", () => {
    // Copy markdown to clipboard
    navigator.clipboard.writeText(unescape(markdown));

    // Update button test
    button_elem.value = "Copied!"

    // Reset button text
    setTimeout (() => {
      button_elem.value = "Copy Markdown"
    }, 2000)
  });

</script>

<style>
  input[name="copy"] {
    width: 150px;
  }
</style>


{% endblock %}